digraph ATM_PARA_CEKME {
    rankdir=TB;
    node [shape=rectangle, style=rounded, fontname="Arial"];

    START [label="KART TAK"];
    INVALID_CARD [label="Kart Geçersiz?"];
    EXIT1 [label="Geçersiz kart\nKart iade\nBitir", shape=diamond, style=filled, fillcolor=lightcoral];
    
    PIN_LOOP [label="PIN Gir"];
    CHECK_PIN [label="PIN Doğru?"];
    WRONG_PIN [label="Hatalı PIN\nHak -1"];
    BLOCK [label="Hak = 0\nKart Bloke\nBitir", shape=diamond, style=filled, fillcolor=lightcoral];
    
    AMOUNT_INPUT [label="Çekilecek Tutarı Gir"];
    CHECK_MULTIPLE [label="Tutar 20'nin katı mı?"];
    INVALID_AMOUNT [label="Geçersiz Tutar\nKart iade\nBitir", shape=diamond, style=filled, fillcolor=lightcoral];
    
    CHECK_BALANCE [label="Tutar > Bakiye?"];
    INSUFFICIENT [label="Yetersiz Bakiye\nKart iade\nBitir", shape=diamond, style=filled, fillcolor=lightcoral];
    
    CHECK_LIMIT [label="Tutar + Bugün Çekilen > Günlük Limit?"];
    LIMIT_EXCEEDED [label="Limit Aşıldı\nKart iade\nBitir", shape=diamond, style=filled, fillcolor=lightcoral];
    
    SUCCESS [label="Bakiye Güncelle\nGünlük Çekilen Güncelle\nPara Ver"];
    END [label="Kart iade\nBitir", shape=oval, style=filled, fillcolor=lightblue];

    // Bağlantılar
    START -> INVALID_CARD;
    INVALID_CARD -> EXIT1 [label="Evet"];
    INVALID_CARD -> PIN_LOOP [label="Hayır"];

    PIN_LOOP -> CHECK_PIN;
    CHECK_PIN -> AMOUNT_INPUT [label="Evet"];
    CHECK_PIN -> WRONG_PIN [label="Hayır"];
    WRONG_PIN -> PIN_LOOP;
    WRONG_PIN -> BLOCK [label="Hak=0"];

    AMOUNT_INPUT -> CHECK_MULTIPLE;
    CHECK_MULTIPLE -> INVALID_AMOUNT [label="Hayır"];
    CHECK_MULTIPLE -> CHECK_BALANCE [label="Evet"];

    CHECK_BALANCE -> INSUFFICIENT [label="Evet"];
    CHECK_BALANCE -> CHECK_LIMIT [label="Hayır"];

    CHECK_LIMIT -> LIMIT_EXCEEDED [label="Evet"];
    CHECK_LIMIT -> SUCCESS [label="Hayır"];

    SUCCESS -> END;
}
